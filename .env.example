API_TOKEN=change-me
COQUI_TOS_AGREED=1
TTS_MODEL=tts_models/multilingual/multi-dataset/xtts_v2
TTS_LANG=en
TTS_SPEAKER=default
WHISPER_MODEL=medium
HF_HOME=/root/.cache/huggingface
TORCH_HOME=/root/.cache/torch
TTS_HOME=/root/.local/share/tts
DIARIZATION_MODEL=pyannote/speaker-diarization
# Optional Hugging Face token for gated models (pyannote, etc.)
# HUGGINGFACE_TOKEN=change-me
# HF_TOKEN=change-me  # legacy name

# Secure auth secrets (generate strong random values for production)
JWT_SECRET=change-me
SESSION_SECRET=change-me
CSRF_SECRET=change-me

# Optional admin bootstrap (created/updated at server startup)
# ADMIN_USERNAME=admin
# ADMIN_PASSWORD=change-me

# Cookies / CORS
# COOKIE_SECURE=1  # enable when behind HTTPS
# CORS_ORIGINS=https://example.com,https://other.example.com
# REDIS_URL=redis://redis:6379/0

# Offline / egress controls
# OFFLINE_MODE=1 forces no downloads/egress (must have caches populated)
OFFLINE_MODE=0
# ALLOW_EGRESS=0 hard-denies outbound connections (except localhost)
ALLOW_EGRESS=1
# ALLOW_HF_EGRESS=1 allows only *.huggingface.co egress when ALLOW_EGRESS=0
ALLOW_HF_EGRESS=0
# Optional override translation model (else Marian -> NLLB fallback)
# TRANSLATION_MODEL=Helsinki-NLP/opus-mt-ja-en
# Optional HF cache override
# TRANSFORMERS_CACHE=/root/.cache/huggingface/transformers

# Optional TTS cloning / voice selection
# If set, will attempt zero-shot clone from this WAV
# TTS_SPEAKER_WAV=/path/to/voice.wav
# Voice presets directory and DB (used when cloning fails / unavailable)
VOICE_PRESET_DIR=/workspace/voices/presets
VOICE_DB=/workspace/voices/presets.json

# Character store encryption (required for persistence)
# Generate a 32-byte random key and base64-encode it.
# Example (bash): python -c "import os,base64; print(base64.b64encode(os.urandom(32)).decode())"
# CHAR_STORE_KEY=change-me
# Optional: read key from a mounted file
# CHAR_STORE_KEY_FILE=/app/secrets/char_store.key

# Retention policy (best-effort secure delete)
RETENTION_DAYS_INPUT=7
RETENTION_DAYS_LOGS=14

# Job limits / quotas
MAX_VIDEO_MIN=120
MAX_UPLOAD_MB=2048
MAX_CONCURRENT=2
DAILY_PROCESSING_MINUTES=240

# Job watchdog timeouts (seconds)
WATCHDOG_AUDIO_S=600
WATCHDOG_DIARIZE_S=1200
WATCHDOG_WHISPER_S=2700
WATCHDOG_TRANSLATE_S=600
WATCHDOG_TTS_S=1800
WATCHDOG_MIX_S=1200

# Model manager prewarm + GPU allocator thresholds
# PREWARM_WHISPER=large-v3,medium,small
# PREWARM_TTS=tts_models/multilingual/multi-dataset/xtts_v2
MODEL_CACHE_MAX=3
GPU_UTIL_MAX=0.85
GPU_MEM_MAX_RATIO=0.90

# Runtime scheduler limits (in-proc)
MAX_CONCURRENCY_GLOBAL=2
MAX_CONCURRENCY_TRANSCRIBE=1
MAX_CONCURRENCY_TTS=1
BACKPRESSURE_Q_MAX=6
# Set to -1 to disable backpressure mode degrade/delay
# BACKPRESSURE_Q_MAX=-1

# Retry / circuit breaker tuning
RETRY_MAX=3
RETRY_BASE_SEC=0.5
RETRY_CAP_SEC=8.0
CB_FAIL_THRESHOLD=5
CB_COOLDOWN_SEC=60

# Optional: basic fallback TTS model name (Coqui, single-speaker)
# TTS_BASIC_MODEL=tts_models/en/ljspeech/tacotron2-DDC

# Ops: backup destination (optional, requires aws cli inside container/host)
# BACKUP_S3_URL=s3://your-bucket/anime-v2-backups/

# Deploy: public HTTPS / tunnel
# DOMAIN=anime.example.com
# CADDY_EMAIL=you@example.com
# CLOUDFLARE_TUNNEL_TOKEN=change-me
